{
	"info": {
		"_postman_id": "rr-bank-api-collection-v2",
		"name": "RR-Bank API Collection",
		"description": "Complete API collection for RR-Bank Banking Application\n\nPhase 1 - Updated: December 2024\n\nThis collection contains all API endpoints for:\n- Authentication (Register, Login, Token Refresh)\n- Account Management (CRUD, Balance, Status, Deposit, Withdraw)\n- Transactions (Transfer, Search, Statistics)\n- Customers (Profile, KYC)\n- Payments (Bill, Merchant)\n- Statements (Generate, Download)\n- Fraud Detection (Alerts, Rules, Risk Scores)\n- Audit Logs (Search, Statistics)\n- Notifications (User notifications)\n- MFA (TOTP, SMS, Email OTP)\n\nâœ… NEW: Initial Deposit transactions are auto-created when account is created with balance > 0",
		"schema": "https://schema.getpostman.com/json/collection/v2.1.0/collection.json"
	},
	"variable": [
		{
			"key": "baseUrl",
			"value": "http://localhost:8080",
			"type": "string"
		},
		{
			"key": "accessToken",
			"value": "",
			"type": "string"
		},
		{
			"key": "refreshToken",
			"value": "",
			"type": "string"
		},
		{
			"key": "userId",
			"value": "",
			"type": "string"
		},
		{
			"key": "customerId",
			"value": "",
			"type": "string"
		},
		{
			"key": "accountId",
			"value": "",
			"type": "string"
		},
		{
			"key": "accountNumber",
			"value": "",
			"type": "string"
		},
		{
			"key": "transactionId",
			"value": "",
			"type": "string"
		}
	],
	"item": [
		{
			"name": "Auth",
			"description": "Authentication endpoints for user registration, login, and token management",
			"item": [
				{
					"name": "Register User",
					"event": [
						{
							"listen": "test",
							"script": {
								"exec": [
									"if (pm.response.code === 200 || pm.response.code === 201) {",
									"    var jsonData = pm.response.json();",
									"    pm.collectionVariables.set('accessToken', jsonData.accessToken);",
									"    pm.collectionVariables.set('refreshToken', jsonData.refreshToken);",
									"    pm.collectionVariables.set('userId', jsonData.userId);",
									"    pm.test('Registration successful', function() {",
									"        pm.expect(jsonData.accessToken).to.not.be.empty;",
									"    });",
									"}"
								],
								"type": "text/javascript"
							}
						}
					],
					"request": {
						"method": "POST",
						"header": [
							{
								"key": "Content-Type",
								"value": "application/json"
							}
						],
						"body": {
							"mode": "raw",
							"raw": "{\n    \"username\": \"testuser\",\n    \"email\": \"testuser@rrbank.com\",\n    \"password\": \"SecurePass123!\",\n    \"firstName\": \"Test\",\n    \"lastName\": \"User\",\n    \"phoneNumber\": \"+1234567890\"\n}"
						},
						"url": {
							"raw": "{{baseUrl}}/api/auth/register",
							"host": ["{{baseUrl}}"],
							"path": ["api", "auth", "register"]
						}
					}
				},
				{
					"name": "Login",
					"event": [
						{
							"listen": "test",
							"script": {
								"exec": [
									"if (pm.response.code === 200) {",
									"    var jsonData = pm.response.json();",
									"    pm.collectionVariables.set('accessToken', jsonData.accessToken);",
									"    pm.collectionVariables.set('refreshToken', jsonData.refreshToken);",
									"    pm.collectionVariables.set('userId', jsonData.userId);",
									"    pm.test('Login successful', function() {",
									"        pm.expect(jsonData.accessToken).to.not.be.empty;",
									"    });",
									"}"
								],
								"type": "text/javascript"
							}
						}
					],
					"request": {
						"method": "POST",
						"header": [
							{
								"key": "Content-Type",
								"value": "application/json"
							}
						],
						"body": {
							"mode": "raw",
							"raw": "{\n    \"usernameOrEmail\": \"testuser@rrbank.com\",\n    \"password\": \"SecurePass123!\"\n}"
						},
						"url": {
							"raw": "{{baseUrl}}/api/auth/login",
							"host": ["{{baseUrl}}"],
							"path": ["api", "auth", "login"]
						}
					}
				},
				{
					"name": "Refresh Token",
					"event": [
						{
							"listen": "test",
							"script": {
								"exec": [
									"if (pm.response.code === 200) {",
									"    var jsonData = pm.response.json();",
									"    pm.collectionVariables.set('accessToken', jsonData.accessToken);",
									"    if (jsonData.refreshToken) {",
									"        pm.collectionVariables.set('refreshToken', jsonData.refreshToken);",
									"    }",
									"    pm.test('Token refreshed', function() {",
									"        pm.expect(jsonData.accessToken).to.not.be.empty;",
									"    });",
									"}"
								],
								"type": "text/javascript"
							}
						}
					],
					"request": {
						"method": "POST",
						"header": [
							{
								"key": "Authorization",
								"value": "Bearer {{refreshToken}}"
							}
						],
						"url": {
							"raw": "{{baseUrl}}/api/auth/refresh",
							"host": ["{{baseUrl}}"],
							"path": ["api", "auth", "refresh"]
						}
					}
				},
				{
					"name": "Health Check",
					"request": {
						"method": "GET",
						"header": [],
						"url": {
							"raw": "{{baseUrl}}/api/auth/health",
							"host": ["{{baseUrl}}"],
							"path": ["api", "auth", "health"]
						}
					}
				}
			]
		},
		{
			"name": "Customers",
			"description": "Customer profile and KYC management",
			"item": [
				{
					"name": "Create Customer",
					"event": [
						{
							"listen": "test",
							"script": {
								"exec": [
									"if (pm.response.code === 201 || pm.response.code === 200) {",
									"    var jsonData = pm.response.json();",
									"    pm.collectionVariables.set('customerId', jsonData.id);",
									"    pm.test('Customer created', function() {",
									"        pm.expect(jsonData.id).to.not.be.empty;",
									"    });",
									"}"
								],
								"type": "text/javascript"
							}
						}
					],
					"request": {
						"method": "POST",
						"header": [
							{
								"key": "Content-Type",
								"value": "application/json"
							},
							{
								"key": "Authorization",
								"value": "Bearer {{accessToken}}"
							}
						],
						"body": {
							"mode": "raw",
							"raw": "{\n    \"userId\": \"{{userId}}\",\n    \"firstName\": \"Test\",\n    \"lastName\": \"User\",\n    \"email\": \"testuser@rrbank.com\",\n    \"phoneNumber\": \"+1234567890\",\n    \"dateOfBirth\": \"1990-01-15\",\n    \"address\": {\n        \"street\": \"123 Main St\",\n        \"city\": \"New York\",\n        \"state\": \"NY\",\n        \"zipCode\": \"10001\",\n        \"country\": \"USA\"\n    }\n}"
						},
						"url": {
							"raw": "{{baseUrl}}/api/customers",
							"host": ["{{baseUrl}}"],
							"path": ["api", "customers"]
						}
					}
				},
				{
					"name": "Get Customer by ID",
					"request": {
						"method": "GET",
						"header": [
							{
								"key": "Authorization",
								"value": "Bearer {{accessToken}}"
							}
						],
						"url": {
							"raw": "{{baseUrl}}/api/customers/{{customerId}}",
							"host": ["{{baseUrl}}"],
							"path": ["api", "customers", "{{customerId}}"]
						}
					}
				},
				{
					"name": "Get Customer by User ID",
					"request": {
						"method": "GET",
						"header": [
							{
								"key": "Authorization",
								"value": "Bearer {{accessToken}}"
							}
						],
						"url": {
							"raw": "{{baseUrl}}/api/customers/user/{{userId}}",
							"host": ["{{baseUrl}}"],
							"path": ["api", "customers", "user", "{{userId}}"]
						}
					}
				}
			]
		},
		{
			"name": "Accounts",
			"description": "Account management, deposits, and withdrawals",
			"item": [
				{
					"name": "Create Account (with Initial Deposit)",
					"event": [
						{
							"listen": "test",
							"script": {
								"exec": [
									"if (pm.response.code === 201 || pm.response.code === 200) {",
									"    var jsonData = pm.response.json();",
									"    pm.collectionVariables.set('accountId', jsonData.id);",
									"    pm.collectionVariables.set('accountNumber', jsonData.accountNumber);",
									"    pm.test('Account created', function() {",
									"        pm.expect(jsonData.id).to.not.be.empty;",
									"        pm.expect(jsonData.accountNumber).to.not.be.empty;",
									"    });",
									"    pm.test('Initial balance set', function() {",
									"        pm.expect(jsonData.balance).to.equal(1000);",
									"    });",
									"}"
								],
								"type": "text/javascript"
							}
						}
					],
					"request": {
						"method": "POST",
						"header": [
							{
								"key": "Content-Type",
								"value": "application/json"
							},
							{
								"key": "Authorization",
								"value": "Bearer {{accessToken}}"
							}
						],
						"body": {
							"mode": "raw",
							"raw": "{\n    \"customerId\": \"{{customerId}}\",\n    \"accountType\": \"CHECKING\",\n    \"currency\": \"USD\",\n    \"initialBalance\": 1000.00\n}"
						},
						"url": {
							"raw": "{{baseUrl}}/api/accounts",
							"host": ["{{baseUrl}}"],
							"path": ["api", "accounts"]
						},
						"description": "Creates a new bank account. If initialBalance > 0, an 'Initial Deposit' transaction is automatically created and will appear in transaction history."
					}
				},
				{
					"name": "Get My Accounts",
					"event": [
						{
							"listen": "test",
							"script": {
								"exec": [
									"if (pm.response.code === 200) {",
									"    var jsonData = pm.response.json();",
									"    pm.test('Accounts returned', function() {",
									"        pm.expect(jsonData).to.be.an('array');",
									"    });",
									"    if (jsonData.length > 0) {",
									"        pm.collectionVariables.set('accountId', jsonData[0].id);",
									"        pm.collectionVariables.set('accountNumber', jsonData[0].accountNumber);",
									"    }",
									"}"
								],
								"type": "text/javascript"
							}
						}
					],
					"request": {
						"method": "GET",
						"header": [
							{
								"key": "Authorization",
								"value": "Bearer {{accessToken}}"
							}
						],
						"url": {
							"raw": "{{baseUrl}}/api/accounts/me",
							"host": ["{{baseUrl}}"],
							"path": ["api", "accounts", "me"]
						},
						"description": "Get all accounts for the authenticated user."
					}
				},
				{
					"name": "Get Account by ID",
					"request": {
						"method": "GET",
						"header": [
							{
								"key": "Authorization",
								"value": "Bearer {{accessToken}}"
							}
						],
						"url": {
							"raw": "{{baseUrl}}/api/accounts/{{accountId}}",
							"host": ["{{baseUrl}}"],
							"path": ["api", "accounts", "{{accountId}}"]
						}
					}
				},
				{
					"name": "Get Account by Number",
					"request": {
						"method": "GET",
						"header": [
							{
								"key": "Authorization",
								"value": "Bearer {{accessToken}}"
							}
						],
						"url": {
							"raw": "{{baseUrl}}/api/accounts/number/{{accountNumber}}",
							"host": ["{{baseUrl}}"],
							"path": ["api", "accounts", "number", "{{accountNumber}}"]
						}
					}
				},
				{
					"name": "Get Account Balance",
					"request": {
						"method": "GET",
						"header": [
							{
								"key": "Authorization",
								"value": "Bearer {{accessToken}}"
							}
						],
						"url": {
							"raw": "{{baseUrl}}/api/accounts/{{accountId}}/balance",
							"host": ["{{baseUrl}}"],
							"path": ["api", "accounts", "{{accountId}}", "balance"]
						}
					}
				},
				{
					"name": "Get Accounts by Customer",
					"request": {
						"method": "GET",
						"header": [
							{
								"key": "Authorization",
								"value": "Bearer {{accessToken}}"
							}
						],
						"url": {
							"raw": "{{baseUrl}}/api/accounts/customer/{{customerId}}",
							"host": ["{{baseUrl}}"],
							"path": ["api", "accounts", "customer", "{{customerId}}"]
						}
					}
				},
				{
					"name": "ðŸ’° Deposit Money",
					"event": [
						{
							"listen": "test",
							"script": {
								"exec": [
									"if (pm.response.code === 200) {",
									"    var jsonData = pm.response.json();",
									"    pm.collectionVariables.set('transactionId', jsonData.id);",
									"    pm.test('Deposit successful', function() {",
									"        pm.expect(jsonData.transactionType).to.equal('DEPOSIT');",
									"        pm.expect(jsonData.status).to.equal('COMPLETED');",
									"    });",
									"    pm.test('Balance updated correctly', function() {",
									"        pm.expect(parseFloat(jsonData.balanceAfter)).to.be.greaterThan(parseFloat(jsonData.balanceBefore));",
									"    });",
									"}"
								],
								"type": "text/javascript"
							}
						}
					],
					"request": {
						"method": "POST",
						"header": [
							{
								"key": "Content-Type",
								"value": "application/json"
							},
							{
								"key": "Authorization",
								"value": "Bearer {{accessToken}}"
							}
						],
						"body": {
							"mode": "raw",
							"raw": "{\n    \"amount\": 500.00,\n    \"currency\": \"USD\",\n    \"description\": \"Cash deposit\"\n}"
						},
						"url": {
							"raw": "{{baseUrl}}/api/accounts/{{accountId}}/deposit",
							"host": ["{{baseUrl}}"],
							"path": ["api", "accounts", "{{accountId}}", "deposit"]
						},
						"description": "Deposit money to an account.\n\n**Request Body:**\n- `amount` (required): Amount to deposit (min: 0.01, max: 1,000,000)\n- `currency` (optional): Currency code (default: USD)\n- `description` (optional): Transaction description\n\n**Response:**\n- Transaction details with `balanceBefore` and `balanceAfter`\n- `transactionType`: DEPOSIT\n- `status`: COMPLETED"
					}
				},
				{
					"name": "ðŸ’¸ Withdraw Money",
					"event": [
						{
							"listen": "test",
							"script": {
								"exec": [
									"if (pm.response.code === 200) {",
									"    var jsonData = pm.response.json();",
									"    pm.collectionVariables.set('transactionId', jsonData.id);",
									"    pm.test('Withdrawal successful', function() {",
									"        pm.expect(jsonData.transactionType).to.equal('WITHDRAWAL');",
									"        pm.expect(jsonData.status).to.equal('COMPLETED');",
									"    });",
									"    pm.test('Balance updated correctly', function() {",
									"        pm.expect(parseFloat(jsonData.balanceAfter)).to.be.lessThan(parseFloat(jsonData.balanceBefore));",
									"    });",
									"}"
								],
								"type": "text/javascript"
							}
						}
					],
					"request": {
						"method": "POST",
						"header": [
							{
								"key": "Content-Type",
								"value": "application/json"
							},
							{
								"key": "Authorization",
								"value": "Bearer {{accessToken}}"
							}
						],
						"body": {
							"mode": "raw",
							"raw": "{\n    \"amount\": 100.00,\n    \"currency\": \"USD\",\n    \"description\": \"ATM withdrawal\"\n}"
						},
						"url": {
							"raw": "{{baseUrl}}/api/accounts/{{accountId}}/withdraw",
							"host": ["{{baseUrl}}"],
							"path": ["api", "accounts", "{{accountId}}", "withdraw"]
						},
						"description": "Withdraw money from an account.\n\n**Request Body:**\n- `amount` (required): Amount to withdraw (min: 0.01, max: 50,000)\n- `currency` (optional): Currency code (default: USD)\n- `description` (optional): Transaction description\n\n**Validations:**\n- Account must be active\n- Sufficient balance required\n\n**Response:**\n- Transaction details with `balanceBefore` and `balanceAfter`\n- `transactionType`: WITHDRAWAL\n- `status`: COMPLETED"
					}
				},
				{
					"name": "Update Account Status (Admin)",
					"request": {
						"method": "PUT",
						"header": [
							{
								"key": "Content-Type",
								"value": "application/json"
							},
							{
								"key": "Authorization",
								"value": "Bearer {{accessToken}}"
							}
						],
						"body": {
							"mode": "raw",
							"raw": "{\n    \"status\": \"ACTIVE\",\n    \"reason\": \"Account activated after verification\"\n}"
						},
						"url": {
							"raw": "{{baseUrl}}/api/accounts/{{accountId}}/status",
							"host": ["{{baseUrl}}"],
							"path": ["api", "accounts", "{{accountId}}", "status"]
						}
					}
				},
				{
					"name": "Get All Accounts (Admin)",
					"request": {
						"method": "GET",
						"header": [
							{
								"key": "Authorization",
								"value": "Bearer {{accessToken}}"
							}
						],
						"url": {
							"raw": "{{baseUrl}}/api/accounts",
							"host": ["{{baseUrl}}"],
							"path": ["api", "accounts"]
						}
					}
				}
			]
		},
		{
			"name": "Transactions",
			"description": "Money transfers and transaction history",
			"item": [
				{
					"name": "Transfer Money",
					"event": [
						{
							"listen": "test",
							"script": {
								"exec": [
									"if (pm.response.code === 200 || pm.response.code === 201) {",
									"    var jsonData = pm.response.json();",
									"    pm.collectionVariables.set('transactionId', jsonData.id);",
									"    pm.test('Transfer successful', function() {",
									"        pm.expect(jsonData.transactionType).to.equal('TRANSFER');",
									"        pm.expect(jsonData.status).to.equal('COMPLETED');",
									"    });",
									"}"
								],
								"type": "text/javascript"
							}
						}
					],
					"request": {
						"method": "POST",
						"header": [
							{
								"key": "Content-Type",
								"value": "application/json"
							},
							{
								"key": "Authorization",
								"value": "Bearer {{accessToken}}"
							}
						],
						"body": {
							"mode": "raw",
							"raw": "{\n    \"fromAccountId\": \"{{accountId}}\",\n    \"toAccountId\": \"<destination-account-id>\",\n    \"amount\": 100.00,\n    \"description\": \"Payment for services\"\n}"
						},
						"url": {
							"raw": "{{baseUrl}}/api/transactions/transfer",
							"host": ["{{baseUrl}}"],
							"path": ["api", "transactions", "transfer"]
						}
					}
				},
				{
					"name": "Get Transaction by ID",
					"request": {
						"method": "GET",
						"header": [
							{
								"key": "Authorization",
								"value": "Bearer {{accessToken}}"
							}
						],
						"url": {
							"raw": "{{baseUrl}}/api/transactions/{{transactionId}}",
							"host": ["{{baseUrl}}"],
							"path": ["api", "transactions", "{{transactionId}}"]
						}
					}
				},
				{
					"name": "Get Transactions by Account",
					"event": [
						{
							"listen": "test",
							"script": {
								"exec": [
									"if (pm.response.code === 200) {",
									"    var jsonData = pm.response.json();",
									"    pm.test('Transactions returned', function() {",
									"        pm.expect(jsonData.content).to.be.an('array');",
									"    });",
									"    pm.test('Contains Initial Deposit', function() {",
									"        var hasInitialDeposit = jsonData.content.some(t => t.description === 'Initial Deposit');",
									"        // This test is optional - only passes if account was created with initial balance",
									"    });",
									"}"
								],
								"type": "text/javascript"
							}
						}
					],
					"request": {
						"method": "GET",
						"header": [
							{
								"key": "Authorization",
								"value": "Bearer {{accessToken}}"
							}
						],
						"url": {
							"raw": "{{baseUrl}}/api/transactions/account/{{accountId}}?page=0&size=20",
							"host": ["{{baseUrl}}"],
							"path": ["api", "transactions", "account", "{{accountId}}"],
							"query": [
								{"key": "page", "value": "0"},
								{"key": "size", "value": "20"}
							]
						},
						"description": "Get all transactions for an account. Returns:\n- Initial Deposit (if account created with balance > 0)\n- Manual Deposits\n- Withdrawals\n- Transfers\n\nOrdered by date DESC."
					}
				},
				{
					"name": "Get Recent Transactions",
					"request": {
						"method": "GET",
						"header": [
							{
								"key": "Authorization",
								"value": "Bearer {{accessToken}}"
							}
						],
						"url": {
							"raw": "{{baseUrl}}/api/transactions/account/{{accountId}}/recent?limit=10",
							"host": ["{{baseUrl}}"],
							"path": ["api", "transactions", "account", "{{accountId}}", "recent"],
							"query": [
								{"key": "limit", "value": "10"}
							]
						}
					}
				},
				{
					"name": "Get Transaction Statistics",
					"request": {
						"method": "GET",
						"header": [
							{
								"key": "Authorization",
								"value": "Bearer {{accessToken}}"
							}
						],
						"url": {
							"raw": "{{baseUrl}}/api/transactions/account/{{accountId}}/stats",
							"host": ["{{baseUrl}}"],
							"path": ["api", "transactions", "account", "{{accountId}}", "stats"]
						}
					}
				},
				{
					"name": "Search Transactions",
					"request": {
						"method": "GET",
						"header": [
							{
								"key": "Authorization",
								"value": "Bearer {{accessToken}}"
							}
						],
						"url": {
							"raw": "{{baseUrl}}/api/transactions/search?accountId={{accountId}}&types=DEPOSIT,WITHDRAWAL,TRANSFER&page=0&size=20",
							"host": ["{{baseUrl}}"],
							"path": ["api", "transactions", "search"],
							"query": [
								{"key": "accountId", "value": "{{accountId}}"},
								{"key": "types", "value": "DEPOSIT,WITHDRAWAL,TRANSFER"},
								{"key": "page", "value": "0"},
								{"key": "size", "value": "20"}
							]
						}
					}
				},
				{
					"name": "Get All Transactions (Admin)",
					"request": {
						"method": "GET",
						"header": [
							{
								"key": "Authorization",
								"value": "Bearer {{accessToken}}"
							}
						],
						"url": {
							"raw": "{{baseUrl}}/api/transactions?page=0&size=20",
							"host": ["{{baseUrl}}"],
							"path": ["api", "transactions"],
							"query": [
								{"key": "page", "value": "0"},
								{"key": "size", "value": "20"}
							]
						}
					}
				}
			]
		},
		{
			"name": "Actuator",
			"description": "System health and monitoring",
			"item": [
				{
					"name": "Health Check",
					"request": {
						"method": "GET",
						"header": [],
						"url": {
							"raw": "{{baseUrl}}/actuator/health",
							"host": ["{{baseUrl}}"],
							"path": ["actuator", "health"]
						}
					}
				},
				{
					"name": "Info",
					"request": {
						"method": "GET",
						"header": [],
						"url": {
							"raw": "{{baseUrl}}/actuator/info",
							"host": ["{{baseUrl}}"],
							"path": ["actuator", "info"]
						}
					}
				}
			]
		}
	]
}
